---
title: "HW2"
author: "Nathalie Fadel"
date: "10/3/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Problem 1
```{r}
library(tidyverse)
transit_data = read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% #data import
janitor::clean_names() %>% #format variable names so they are all lowercase snake
select(line:entry, vending, ada) %>%  #keep only these variables
mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE)) #recode the entry variable

#These data aren't necessarily tidy as they are right now. Currently, there are 19 variables (columns) and 1868 rows. The variable names are all formatted the same way and some variables have been discarded, but the routes 1-11 variables don't say much about the dataset unless you already know that the more routes the station services, the more columns that station will have filled in. This is not a good way of organizing and expressing this data. 

nrow(distinct(transit_data, line, station_name)) #how many distinct stations are there? 465.
nrow(filter(distinct(transit_data, line, station_name, ada), ada == TRUE)) #how many stations are ada compliant? 84.
nrow(filter(transit_data, entry == TRUE, vending == "NO"))/nrow(filter(transit_data, vending == "NO")) #proportion of stations with entry but no vending machine = 0.377

transit_data_tidy = (gather(transit_data, key = route_number, value = route, route1:route11)) #new dataframe where route number and route name are two variables
transit_data_tidy

nrow(filter(distinct(transit_data_tidy, line, station_name, route), route == "A"))
#60 stations on the A line

nrow(filter(distinct(transit_data_tidy, line, station_name, route, ada), route == "A", ada == TRUE)) #of those 60, only 17 are ADA compliant. SAD!
```

#Problem 2
```{r}
library(readxl)
mr_trash_wheel = read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", "Mr. Trash Wheel", range = "A2:N338") %>% #import mr trash wheel datasheet from cell A2 to N258
janitor::clean_names() %>% #clean up names of variables
  filter(!is.na(dumpster)) %>% #filter out dumpster totals
  mutate(sports_balls = round(sports_balls)) %>% #round 
  mutate(sports_balls = as.integer(sports_balls)) #make it an integer

precip_data_2016 = read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", "2016 Precipitation", range = "A2:B14") %>%
  janitor::clean_names() %>%
  mutate(year = 2016) #add a year column
  
precip_data_2017 = read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", "2017 Precipitation", range = "A2:B14") %>%
  janitor::clean_names() %>%
  filter(!is.na(total)) %>% #filter out months with no data
  mutate(year = 2017) #add year column

precip_stack <- rbind(
  mutate(
    precip_data_2016, month = month.name), 
  mutate(
      precip_data_2017, month = month.name)) #make new dataset with 2016 and 2017 precipitation datasets stacked on top of each other, and change month number to month name

nrow(mr_trash_wheel) #285 observations
mr_trash_wheel %>% filter(year == "2017") %>% summarise(median(sports_balls)) #median number of sports balls picked up in 2017 was 8

nrow(precip_stack) #24 observations
precip_stack %>% filter(year == "2017") %>% summarise(sum(total)) #32.93 inches of rain total
```